<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <meta name="generator" content="sphinx-4.4.0, furo 2022.03.04"/>
        <title>Install Input Data on Parallel Cluster - pcluster-cmaq documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=935aa2abcc5c1da4283d1dc201fb1f0add16d23a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=25ceb02ed1c46dc30f2321ff83e92799f69dfdb9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pcluster-cmaq  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">pcluster-cmaq  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  
</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="install-input-data-on-parallel-cluster">
<h1>Install Input Data on Parallel Cluster<a class="headerlink" href="#install-input-data-on-parallel-cluster" title="Permalink to this headline">#</a></h1>
<section id="install-aws-cli-to-obtain-data-from-aws-s3-bucket">
<h2>Install AWS CLI to obtain data from AWS S3 Bucket<a class="headerlink" href="#install-aws-cli-to-obtain-data-from-aws-s3-bucket" title="Permalink to this headline">#</a></h2>
<p>see https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html</p>
<p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/shared</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip"</span> <span class="pre">-o</span> <span class="pre">"awscliv2.zip"</span> <span class="pre">unzip</span> <span class="pre">awscliv2.zip</span> <span class="pre">sudo</span> <span class="pre">./aws/install</span></code></p>
<section id="verify-you-can-run-the-aws-command">
<h3>Verify you can run the aws command<a class="headerlink" href="#verify-you-can-run-the-aws-command" title="Permalink to this headline">#</a></h3>
<p><code class="docutils literal notranslate"> <span class="pre">aws</span> <span class="pre">--help</span></code></p>
<p>If not, you may need to logout and back in.</p>
<p>Set up your credentials for using s3 copy (you can skip this if you do not have credentials)</p>
<p><code class="docutils literal notranslate"><span class="pre">aws</span> <span class="pre">configure</span></code></p>
</section>
</section>
<section id="copy-input-data-from-s3-bucket-to-lustre-filesystem">
<h2>Copy Input Data from S3 Bucket to lustre filesystem<a class="headerlink" href="#copy-input-data-from-s3-bucket-to-lustre-filesystem" title="Permalink to this headline">#</a></h2>
<p>Verify that the /fsx directory exists; this is a lustre file system where the I/O is fastest</p>
<p><code class="docutils literal notranslate"><span class="pre">ls</span> <span class="pre">/fsx</span></code></p>
</section>
<section id="use-the-s3-script-to-copy-the-conus-input-data-from-the-cmas-s3-bucket">
<h2>Use the S3 script to copy the CONUS input data from the CMAS s3 bucket<a class="headerlink" href="#use-the-s3-script-to-copy-the-conus-input-data-from-the-cmas-s3-bucket" title="Permalink to this headline">#</a></h2>
<p>Data will be saved to the /fsx file system</p>
<p><code class="docutils literal notranslate"><span class="pre">/shared/pcluster-cmaq/s3_scripts/s3_copy_nosign_conus_cmas_to_fsx.csh</span></code></p>
<p>if the first method works, then you can skip the alternative method listed next..</p>
</section>
<section id="use-alternative-s3-script-to-copy-the-conus-input-data-from-the-epa-s3-bucket-to-fsx-volume-on-the-cluster">
<h2>Use Alternative S3 script to copy the CONUS input data from the EPA s3 bucket to /fsx volume on the cluster.<a class="headerlink" href="#use-alternative-s3-script-to-copy-the-conus-input-data-from-the-epa-s3-bucket-to-fsx-volume-on-the-cluster" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">/shared/pcluster-cmaq/s3_scripts/s3_copy_nosign_conus_epa_to_fsx.csh</span></code></p>
<p>check that the resulting directory structure matches the run script</p>
<p>Note, this input data requires 44 GB of disk space  (if you use the yaml file to import the data to the lustre file system rather than copying the data you save this space)</p>
<p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">/fsx/data/CONUS</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">du</span> <span class="pre">-sh</span></code></p>
<p>output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">44</span><span class="n">G</span>     <span class="o">.</span>
</pre></div>
</div>
<p>CMAQ Parallel Cluster is configured to have 1.2 Terrabytes of space on /fsx filesystem (minimum size allowed for lustre /fsx), to allow multiple output runs to be stored.</p>
</section>
<section id="for-parallel-cluster-import-the-input-data-from-a-public-s3-bucket">
<h2>For Parallel Cluster: Import the Input data from a public S3 Bucket<a class="headerlink" href="#for-parallel-cluster-import-the-input-data-from-a-public-s3-bucket" title="Permalink to this headline">#</a></h2>
<p>A second method is available to import the data on the lustre file system using the yaml file to specify the s3 bucket location in the yaml file, rather than using the above aws s3 copy commands.</p>
<section id="second-method-import-the-data-by-specifying-it-in-the-yaml-file-example-available-in-c5n-18xlarge-ebs-shared-fsx-import-yaml">
<h3>Second Method: Import the data by specifying it in the yaml file - example available in c5n-18xlarge.ebs_shared.fsx_import.yaml<a class="headerlink" href="#second-method-import-the-data-by-specifying-it-in-the-yaml-file-example-available-in-c5n-18xlarge-ebs-shared-fsx-import-yaml" title="Permalink to this headline">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">-</span> <span class="n">MountDir</span><span class="p">:</span> <span class="o">/</span><span class="n">fsx</span>
    <span class="n">Name</span><span class="p">:</span> <span class="n">name2</span>
    <span class="n">StorageType</span><span class="p">:</span> <span class="n">FsxLustre</span>
    <span class="n">FsxLustreSettings</span><span class="p">:</span>
      <span class="n">StorageCapacity</span><span class="p">:</span> <span class="mi">1200</span>
      <span class="n">ImportPath</span><span class="p">:</span> <span class="n">s3</span><span class="p">:</span><span class="o">//</span><span class="n">conus</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="mi">2</span><span class="n">day</span>    <span class="o">&lt;&lt;&lt;</span>  <span class="n">specify</span> <span class="n">name</span> <span class="n">of</span> <span class="n">S3</span> <span class="n">bucket</span>
</pre></div>
</div>
<p>This requires that the S3 bucket specified is publically available</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Liz Adams
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Install Input Data on Parallel Cluster</a><ul>
<li><a class="reference internal" href="#install-aws-cli-to-obtain-data-from-aws-s3-bucket">Install AWS CLI to obtain data from AWS S3 Bucket</a><ul>
<li><a class="reference internal" href="#verify-you-can-run-the-aws-command">Verify you can run the aws command</a></li>
</ul>
</li>
<li><a class="reference internal" href="#copy-input-data-from-s3-bucket-to-lustre-filesystem">Copy Input Data from S3 Bucket to lustre filesystem</a></li>
<li><a class="reference internal" href="#use-the-s3-script-to-copy-the-conus-input-data-from-the-cmas-s3-bucket">Use the S3 script to copy the CONUS input data from the CMAS s3 bucket</a></li>
<li><a class="reference internal" href="#use-alternative-s3-script-to-copy-the-conus-input-data-from-the-epa-s3-bucket-to-fsx-volume-on-the-cluster">Use Alternative S3 script to copy the CONUS input data from the EPA s3 bucket to /fsx volume on the cluster.</a></li>
<li><a class="reference internal" href="#for-parallel-cluster-import-the-input-data-from-a-public-s3-bucket">For Parallel Cluster: Import the Input data from a public S3 Bucket</a><ul>
<li><a class="reference internal" href="#second-method-import-the-data-by-specifying-it-in-the-yaml-file-example-available-in-c5n-18xlarge-ebs-shared-fsx-import-yaml">Second Method: Import the data by specifying it in the yaml file - example available in c5n-18xlarge.ebs_shared.fsx_import.yaml</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    </body>
</html>